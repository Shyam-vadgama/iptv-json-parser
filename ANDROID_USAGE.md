# Android App Integration Guide

This guide explains how to use the IPTV JSON API generated by this backend in your Android application.

## 1. API Endpoints

Your data is hosted on GitHub Pages. Replace `<username>` and `<repo-name>` with your actual details (e.g., `https://shyam-vadgama.github.io/iptv-json-parser/`).

- **Base URL:** `https://shyam-vadgama.github.io/iptv-json-parser/`
- **Full Channel List:** `channels.json` (Best for detailed apps)
- **Categories:** `categories.json` (For filter chips/tabs)
- **Minified List:** `streams.min.json` (Best for low-bandwidth start-up)

## 2. Dependencies

Add these to your `app/build.gradle.kts`:

```kotlin
dependencies {
    // Networking
    implementation("com.squareup.retrofit2:retrofit:2.9.0")
    implementation("com.squareup.retrofit2:converter-gson:2.9.0")

    // Image Loading (for logos)
    implementation("io.coil-kt:coil:2.5.0")

    // Video Player (ExoPlayer / Media3)
    implementation("androidx.media3:media3-exoplayer:1.2.0")
    implementation("androidx.media3:media3-ui:1.2.0")
}
```

## 3. Data Models

Create Kotlin data classes to match your JSON structure.

**`Channel.kt`** (for `channels.json`)
```kotlin
data class Channel(
    val name: String?,
    val logo: String?,
    val url: String?,
    val category: String?,
    val tvg: Tvg?
)

data class Tvg(
    val id: String?,
    val name: String?
)
```

## 4. Networking (Retrofit)

**`IptvApiService.kt`**
```kotlin
import retrofit2.http.GET

interface IptvApiService {
    @GET("channels.json")
    suspend fun getChannels(): List<Channel>

    @GET("categories.json")
    suspend fun getCategories(): List<String>
}
```

**Usage in ViewModel/Repository:**
```kotlin
val retrofit = Retrofit.Builder()
    .baseUrl("https://shyam-vadgama.github.io/iptv-json-parser/")
    .addConverterFactory(GsonConverterFactory.create())
    .build()

val api = retrofit.create(IptvApiService::class.java)

// In a coroutine
val channels = api.getChannels()
```

## 5. Playing a Stream (ExoPlayer)

In your Activity or Fragment:

```kotlin
// XML Layout should have:
// <androidx.media3.ui.PlayerView
//     android:id="@+id/player_view"
//     android:layout_width="match_parent"
//     android:layout_height="300dp" />

val player = ExoPlayer.Builder(context).build()
binding.playerView.player = player

// When a user clicks a channel:
val mediaItem = MediaItem.fromUri(channel.url)
player.setMediaItem(mediaItem)
player.prepare()
player.play()
```

## 6. Handling Errors

Since some streams might be offline (404/403), listen for player errors:

```kotlin
player.addListener(object : Player.Listener {
    override fun onPlayerError(error: PlaybackException) {
        Toast.makeText(context, "Stream offline", Toast.LENGTH_SHORT).show()
        // Logic to report broken link or switch channel
    }
})
```
